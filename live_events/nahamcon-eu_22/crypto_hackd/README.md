# Brief Writeup

## Description
> Author: @Gary#6971

`Some hardware hackers were able to extract my d by using simple power analysis on the Square & Multiply Algorithm. It's okay though because I know a trick! No more hacking my d pls. `

## Writeup

This is just straight up math. We have two sets of 4 equations to work with here. Let $c_0, c_1$ represent the ciphertexts, and let $f_0, f_1$ represent the plaintexts. Let $r_i$ represent a random number generated by 
`rvals = [random.randrange(2, n-1) for _ in range(3)]`. The first set of equations is below:
$$
\begin{align*}
c_0 &= f_0^e \pmod{n} \\
c'_0 &= c_0 + r_0n \\
d'_0 &= d + r_1\phi \\
n'_0 &= r_2n
\end{align*}
$$

The second set of equations look similar:
$$
\begin{align*}
c_1 &= f_1^e \pmod{n} \\
c'_1 &= c_1 + r_3n \\
d'_1 &= d + r_4\phi \\
n'_1 &= r_5n
\end{align*}
$$

We really only care about one equation here. Notice that the equations involving $d$ reuse that variable, which is significant considering it contains $d$ and $\phi$. We can then do the following algebra:

$$
\begin{align*}
d'_0 - d'_1 &= (d + r_1\phi) - (d + r_4\phi) \\
d'_0 - d'_1 &= r_1\phi - r_4\phi \\
\frac{d'_0 - d'_1}{r_1 - r_4} &= \phi
\end{align*}
$$

If we know $\phi$, we can calculate the decryption exponent $d$ and recover both parts of the flag, which you can see in `solve.py`.